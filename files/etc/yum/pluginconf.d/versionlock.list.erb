#
# Yum package version locks.
#
# !!!!! this file is maintained by puppet !!!!!
#
<% def form_versionlock(k,v) -%>
<%   if @versionlocks[k].is_a?(Hash) -%>
<%#    New format -%>
<%     versionlock = '' -%>
<%     versionlock << '%i:' % [ v.key?('epoch') ? v['epoch'] : 0 ] -%>
<%     versionlock <<  '%s-' % [ v.key?('name') ? v['name'] : k ] -%>
<%     versionlock << v['version'] -%>
<%#    Folks keep embedding release strings in the version. -%>
<%     if not v['version'].include?('-') -%>
<%       versionlock << '-%s' % [ v.key?('release') ? v['release'] : '*' ] -%>
<%     end -%>
<%     versionlock << '.%s' % [ v.key?('arch') ? v['arch'] : '*' ] -%>
<%   else -%>
<%#    Legacy format -%>
<%     versionlock = '0:%s-%s.*' % [k ,v] -%>
<%   end -%>
<%   return versionlock -%>
<% end -%>
<% @versionlocks.sort.map do |k,v| -%>
<%= form_versionlock(k,v) %>
<% end -%>
